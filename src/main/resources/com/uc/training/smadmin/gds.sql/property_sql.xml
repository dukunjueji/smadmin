<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="com.uc.training.smadmin.gds.dao.PropertyDao">
    <!--新增商品属性-->
    <insert id="insertProperty" parameterClass="com.uc.training.smadmin.gds.model.Property">
        INSERT INTO t_gds_property
        (goods_id, stock, discount_price, sale_price, property, is_discount, create_emp, modify_emp)
        VALUES (#goodsId#,#stock#,#discountPrice#,#salePrice#,#property#,#isDiscount#,#createEmp#,#modifyEmp#)
        <selectKey resultClass="java.lang.Long" keyProperty="id">
            SELECT LAST_INSERT_ID() as id;
        </selectKey>
    </insert>

    <!--更新商品属性-->
    <update id="updateProperty" parameterClass="com.uc.training.smadmin.gds.model.Property">
        UPDATE t_gds_property
        SET   stock=#stock#,
              discount_price=#discountPrice#,
              sale_price=#salePrice#,
              property=#property#,
              is_discount=#isDiscount#,
              modify_emp=#modifyEmp#
        WHERE goods_id = #goodsId#
    </update>

    <!--后台通过商品id获取商品属性-->
    <select id="getPropertyListByGoodsId" parameterClass="Long" resultClass="com.uc.training.smadmin.gds.re.AdminPropertyListRE">
        SELECT
            gp.id AS id,
            gp.goods_id AS goodsId,
            gp.stock AS stock,
            gp.discount_price AS discountPrice,
            gp.sale_price AS  salePrice,
            gp.property AS property,
            gp.is_discount AS isDiscount
        FROM   t_gds_property gp
        WHERE gp.goods_id = #goodsId#
    </select>

    <!-- 通过商品id查找商品类型数量 -->
    <select id="getPropertyCountByGoodsId" parameterClass="Long" resultClass="Integer">
        SELECT
          count(1)
        FROM
          t_gds_property
        WHERE goods_id = #goodsId#
    </select>
</sqlMap>